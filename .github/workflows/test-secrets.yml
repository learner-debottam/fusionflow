name: Test Secrets Configuration

on:
  workflow_dispatch:
    inputs:
      test_npm:
        description: 'Test NPM token'
        required: false
        default: 'true'
      test_snyk:
        description: 'Test Snyk token'
        required: false
        default: 'false'

jobs:
  test-secrets:
    name: Test Secrets
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Test NPM Token
        if: inputs.test_npm == 'true'
        run: |
          if [ -n "${{ secrets.NPM_TOKEN }}" ]; then
            echo "‚úÖ NPM_TOKEN is configured"
            echo "Token length: ${#NPM_TOKEN}"
            echo "Token starts with: ${NPM_TOKEN:0:4}..."
          else
            echo "‚ùå NPM_TOKEN is not configured"
            exit 1
          fi

      - name: Test Snyk Token
        if: inputs.test_snyk == 'true'
        run: |
          if [ -n "${{ secrets.SNYK_TOKEN }}" ]; then
            echo "‚úÖ SNYK_TOKEN is configured"
            echo "Token length: ${#SNYK_TOKEN}"
          else
            echo "‚ùå SNYK_TOKEN is not configured"
            exit 1
          fi

      - name: Test Docker Credentials
        run: |
          if [ -n "${{ secrets.DOCKER_USERNAME }}" ] && [ -n "${{ secrets.DOCKER_PASSWORD }}" ]; then
            echo "‚úÖ Docker credentials are configured"
            echo "Username: ${{ secrets.DOCKER_USERNAME }}"
          else
            echo "‚ö†Ô∏è Docker credentials are not configured (optional)"
          fi

      - name: Summary
        run: |
          echo "üîê Secrets Configuration Summary:"
          echo "================================"
          echo "NPM_TOKEN: $([ -n "${{ secrets.NPM_TOKEN }}" ] && echo "‚úÖ Configured" || echo "‚ùå Missing")"
          echo "SNYK_TOKEN: $([ -n "${{ secrets.SNYK_TOKEN }}" ] && echo "‚úÖ Configured" || echo "‚ö†Ô∏è Optional")"
          echo "DOCKER_USERNAME: $([ -n "${{ secrets.DOCKER_USERNAME }}" ] && echo "‚úÖ Configured" || echo "‚ö†Ô∏è Optional")"
          echo "DOCKER_PASSWORD: $([ -n "${{ secrets.DOCKER_PASSWORD }}" ] && echo "‚úÖ Configured" || echo "‚ö†Ô∏è Optional")"
          echo ""
          echo "üéâ If NPM_TOKEN shows ‚úÖ, you're ready to publish packages!"
